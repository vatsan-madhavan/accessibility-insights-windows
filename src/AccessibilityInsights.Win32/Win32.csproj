<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <RootNamespace>AccessibilityInsights.Win32</RootNamespace>
    <AssemblyName>AccessibilityInsights.Win32</AssemblyName>
    <TargetFramework>net471</TargetFramework>
    <Revision Condition=" '$(BUILD_BUILDNUMBER)' != '' ">$(BUILD_BUILDNUMBER.Substring($(BUILD_BUILDNUMBER.LastIndexOf(`.`))))</Revision>
    <Revision Condition=" '$(BUILD_BUILDNUMBER)' == '' ">.1</Revision>
    <CurrentDateString Condition=" '$(BUILD_BUILDNUMBER)' != '' ">$(BUILD_BUILDNUMBER.Substring(0, $(BUILD_BUILDNUMBER.LastIndexOf(`.`))))</CurrentDateString>
    <CurrentDateString Condition=" '$(BUILD_BUILDNUMBER)' == '' ">$([System.DateTime]::Now.ToString(`yyyy-MM-dd`))</CurrentDateString>
    <CountDate>$([System.DateTime]::ParseExact(`2017-01-01`,`yyyy-MM-dd`,null))</CountDate>
    <BuildNumber>1.1.$([System.Math]::Round($([System.DateTime]::ParseExact($(CurrentDateString),`yyyy-MM-dd`,null).Subtract($(CountDate)).TotalDays)).ToString(`0000`))$(Revision)</BuildNumber>
    <AssemblyTitle>AccessibilityInsights.Win32</AssemblyTitle>
    <Product>AccessibilityInsights.Win32</Product>
    <TreatWarningsAsErrors>true</TreatWarningsAsErrors>
  </PropertyGroup>
  <Import Project="..\..\build\settings.targets" />
  <Target Name="BeforeBuildMigrated" BeforeTargets="PreBuildEvent">
    <WriteLinesToFile File="$(TEMP)\A11yInsightsVersionInfo.cs" Overwrite="True" Lines="[assembly: System.Reflection.AssemblyVersion(&quot;$(BuildNumber)&quot;)] // Generated by build" />
    <ItemGroup>
      <_versionInfoProps Remove="@(_versionInfoProps)" />
      <_versionInfoProps Include="&lt;Project&gt;" />
      <_versionInfoProps Include="  &lt;!-- Generated by build --&gt;" />
      <_versionInfoProps Include="  &lt;PropertyGroup&gt;" />
      <_versionInfoProps Include="    &lt;BuildNumber&gt;$(BuildNumber)&lt;/BuildNumber&gt;" />
      <_versionInfoProps Include="  &lt;/PropertyGroup&gt;" />
      <_versionInfoProps Include="&lt;/Project&gt;" />
    </ItemGroup>
    <WriteLinesToFile File="$(TEMP)\A11yInsightsVersionInfo.props" Overwrite="True" Lines="@(_versionInfoProps)" />
  </Target>
  <ItemGroup>
    <PackageReference Include="System.Data.DataSetExtensions" Version="$(SystemDataDataSetExtensionsVersion)" />
    <PackageReference Include="Microsoft.CSharp" Version="$(MicrosoftCSharpVersion)" />
    <PackageReference Include="System.Net.Http" Version="$(SystemNetHttpVersion)" />
  </ItemGroup>
  <ItemGroup>
    <PackageReference Include="Microsoft.CodeAnalysis.FxCopAnalyzers" Version="$(MicrosoftCodeAnalysisFxCopAnalyzersVersion)">
      <PrivateAssets>all</PrivateAssets>
    </PackageReference>
    <PackageReference Include="Microsoft.CodeAnalysis.VersionCheckAnalyzer" Version="$(MicrosoftCodeAnalysisVersionCheckAnalyzerVersion)" />
    <PackageReference Include="Microsoft.CodeQuality.Analyzers" Version="$(MicrosoftCodeQualityAnalyzersVersion)">
      <PrivateAssets>all</PrivateAssets>
    </PackageReference>
    <PackageReference Include="Microsoft.NetCore.Analyzers" Version="$(MicrosoftNetCoreAnalyzersVersion)">
      <PrivateAssets>all</PrivateAssets>
    </PackageReference>
    <PackageReference Include="Microsoft.NetFramework.Analyzers" Version="$(MicrosoftNetFrameworkAnalyzersVersion)">
      <PrivateAssets>all</PrivateAssets>
    </PackageReference>
    <PackageReference Include="Microsoft.VisualStudioEng.MicroBuild.Core" Version="$(MicrosoftVisualStudioEngMicroBuildCoreVersion)">
      <PrivateAssets>all</PrivateAssets>
    </PackageReference>
    <PackageReference Include="Text.Analyzers" Version="$(TextAnalyzersVersion)">
      <PrivateAssets>all</PrivateAssets>
    </PackageReference>
  </ItemGroup>
</Project>